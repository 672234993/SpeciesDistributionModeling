SpeciesDistributionModeling
===========================
README 21 May 2014

Configuration:
	First, initialize user-configurable variables in Config.sh. Required input files include:

	1. Metadata: this is a csv file containing metadata for the samples. Required fields are 'SampleID', 'Latitude', 'Longitude', 'Elevation' (can be set to 0 to ignore), 'Month', 'Day', and 'Year'. Each row in the metadata file represents a sample.

	2. Samples: the samples should be listed in a csv file and given one per line with three fields: 
		-the sample ID (names correspond to the metadata file)
		-OTU names (separate taxonomic levels by semicolons)
		-number of reads in each sample
	   Thus,
		
		S123,k__Bacteria;p__Proteobacteria;c__Alphaproteobacteria,2
	
	   would indicate that 2 reads belonging to c__Alphaproteobacteria were observed in sample s123. If multiple OTUs with the same taxonomic assignment were observed in the same sample, they should be listed on separate lines; i.e.,

		S123,k__Bacteria;p__Proteobacteria;c__Alphaproteobacteria,2
		S123,k__Bacteria;p__Proteobacteria;c__Alphaproteobacteria,5

	   would be interpreted as two different Alphaproteobacteria OTUs, one with 2 reads and one with 5 reads.

	3. Shape files: The user can also provide a text dump of shape files for to mask the region of interest (stored in the Data/Masks directory for the example dataset). The variable sRasterMaskPath should be initialized to the path to the shape file (.shp.txt). A text version of the dbf file accompanying the shape file be included in the same directory as the *.shp.txt file with the suffix *.dbf.csv. The text version of the shapefile can be generated by shpdump, available at http://shapelib.maptools.org/shapelib-tools.html.
	
	4. Set sRasterDir with the directory where environmental rasters will be located. Raster files should be at a 0.5 latitude/longitude degree resolution and be in NetCDF format. Details on the NetCDF format are available at www.unidata.ucar.edu/software/netcdf.

	5. Set rgsTaxon to a list of taxa to be analyzed in a space-separated list in parentheses. Use 'all' for all taxa. For each taxon given, a corresponding response variable should be provided in rgsResponseVar. Options for response variables include 'LogRichness', 'LogShannonDiversity', and 'LogitRelAbundance'.

To run:
	./SDM.sh <project_name> 

	<project_name> is the directory that will be created to store the output. If the directory "Output/<project_name>" exists, the program will quit so as not to overwrite prior results.

Output: 
	A subdirectory in output with your project name will be created. Inside of this directory will be a directory for each taxon x response variable set in the  Config.sh file. Each subdirectory will have the following files:

	<taxon>.<var>.<mode>.coef - this file contains the estimated coefficients and names of the variables in the selected model.
	<taxon>.<var>.<mode>.cval - this file contains the leave-one-out cross validation results for the selected model. Each row represents a sample.
	<taxon>.<var>.<mode>.data - this file contains the data used to build the model.
	<taxon>.<var>.<mode>.log - this file contains a log of the commands used to run the analysis
	<taxon>.<var>.<mode>.mess - this file contains the proportion of area with non-error values for the rasters and MESS scores (http://onlinelibrary.wiley.com/doi/10.1111/j.2041-210X.2010.00036.x/full) for each raster.
	<taxon>.<var>.<mode>.modl - this file contains the best models found for different numbers of predictors. The selected model is indicated with an arrow.
	<taxon>.<var>.<mode>.nc - this file contains the predicted diversity map, which can be viewed using Panoply (http://www.giss.nasa.gov/tools/panoply) or another NetCDF viewer.
	<taxon>.<var>.<mode>.vars - this file contains a list of variables that passed the coverage thresholds, viewable in the *.mess file.
